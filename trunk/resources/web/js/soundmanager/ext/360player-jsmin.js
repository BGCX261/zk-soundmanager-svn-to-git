var threeSixtyPlayer,ThreeSixtyPlayer;
(function(g){function r(){var a=this,d=this,n=soundManager,j=navigator.userAgent,o=j.match(/msie/i),c=j.match(/opera/i),h=j.match(/safari/i),k=j.match(/chrome/i);j.match(/firefox/i);var m=j.match(/ipad|iphone/i),s=typeof g.G_vmlCanvasManager==="undefined"&&typeof document.createElement("canvas").getContext("2d")!=="undefined",l=c||k?359.9:360;this.excludeClass="threesixty-exclude";this.links=[];this.sounds=[];this.soundsByURL=[];this.indexByURL=[];this.lastTouchedSound=this.lastSound=null;this.soundCount=
0;this.vuMeter=this.oUIImageMap=this.oUITemplate=null;this.callbackCount=0;this.peakDataHistory=[];this.config={playNext:!1,autoPlay:!1,allowMultiple:!1,loadRingColor:"#ccc",playRingColor:"#000",backgroundRingColor:"#eee",segmentRingColor:"rgba(255,255,255,0.33)",segmentRingColorAlt:"rgba(0,0,0,0.1)",loadRingColorMetadata:"#ddd",playRingColorMetadata:"rgba(128,192,256,0.9)",circleDiameter:null,circleRadius:null,animDuration:500,animTransition:g.Animator.tx.bouncy,showHMSTime:!1,scaleFont:!0,useWaveformData:!1,
waveformDataColor:"#0099ff",waveformDataDownsample:3,waveformDataOutside:!1,waveformDataConstrain:!1,waveformDataLineRatio:0.64,useEQData:!1,eqDataColor:"#339933",eqDataDownsample:4,eqDataOutside:!0,eqDataLineRatio:0.54,usePeakData:!0,peakDataColor:"#ff33ff",peakDataOutside:!0,peakDataLineRatio:0.5,useAmplifier:!0,fontSizeMax:null,useFavIcon:!1};this.css={sDefault:"sm2_link",sBuffering:"sm2_buffering",sPlaying:"sm2_playing",sPaused:"sm2_paused"};this.addEventHandler=function(b,a,f){return typeof g.attachEvent===
"undefined"?b.addEventListener(a,f,!1):b.attachEvent("on"+a,f)};this.removeEventHandler=function(b,a,f){return typeof g.attachEvent==="undefined"?b.removeEventListener(a,f,!1):b.detachEvent("on"+a,f)};this.hasClass=function(b,a){return typeof b.className!=="undefined"?b.className.match(RegExp("(\\s|^)"+a+"(\\s|$)")):!1};this.addClass=function(b,e){if(!b||!e||a.hasClass(b,e))return!1;b.className=(b.className?b.className+" ":"")+e};this.removeClass=function(b,e){if(!b||!e||!a.hasClass(b,e))return!1;
b.className=b.className.replace(RegExp("( "+e+")|("+e+")","g"),"")};this.getElementsByClassName=function(b,e,f){var q=f||document,f=[],i,c=[];if(typeof e!=="undefined"&&typeof e!=="string")for(i=e.length;i--;){if(!c||!c[e[i]])c[e[i]]=q.getElementsByTagName(e[i])}else c=e?q.getElementsByTagName(e):q.all||q.getElementsByTagName("*");if(typeof e!=="string")for(i=e.length;i--;)for(q=c[e[i]].length;q--;)a.hasClass(c[e[i]][q],b)&&f.push(c[e[i]][q]);else for(i=0;i<c.length;i++)a.hasClass(c[i],b)&&f.push(c[i]);
return f};this.getParentByNodeName=function(b,a){if(!b||!a)return!1;for(a=a.toLowerCase();b.parentNode&&a!==b.parentNode.nodeName.toLowerCase();)b=b.parentNode;return b.parentNode&&a===b.parentNode.nodeName.toLowerCase()?b.parentNode:null};this.getParentByClassName=function(b,e){if(!b||!e)return!1;for(;b.parentNode&&!a.hasClass(b.parentNode,e);)b=b.parentNode;return b.parentNode&&a.hasClass(b.parentNode,e)?b.parentNode:null};this.getSoundByURL=function(b){return typeof a.soundsByURL[b]!=="undefined"?
a.soundsByURL[b]:null};this.isChildOfNode=function(b,a){if(!b||!b.parentNode)return!1;a=a.toLowerCase();do b=b.parentNode;while(b&&b.parentNode&&b.nodeName.toLowerCase()!==a);return b&&b.nodeName.toLowerCase()===a?b:null};this.isChildOfClass=function(b,e){if(!b||!e)return!1;for(;b.parentNode&&!a.hasClass(b,e);)b=a.findParent(b);return a.hasClass(b,e)};this.findParent=function(b){if(!b||!b.parentNode)return!1;b=b.parentNode;if(b.nodeType===2)for(;b&&b.parentNode&&b.parentNode.nodeType===2;)b=b.parentNode;
return b};this.getStyle=function(b,a){try{if(b.currentStyle)return b.currentStyle[a];else if(g.getComputedStyle)return document.defaultView.getComputedStyle(b,null).getPropertyValue(a)}catch(f){}return null};this.findXY=function(b){var a=0,f=0;do a+=b.offsetLeft,f+=b.offsetTop;while(b=b.offsetParent);return[a,f]};this.getMouseXY=function(b){b=b?b:g.event;m&&b.touches&&(b=b.touches[0]);if(b.pageX||b.pageY)return[b.pageX,b.pageY];else if(b.clientX||b.clientY)return[b.clientX+a.getScrollLeft(),b.clientY+
a.getScrollTop()]};this.getScrollLeft=function(){return document.body.scrollLeft+document.documentElement.scrollLeft};this.getScrollTop=function(){return document.body.scrollTop+document.documentElement.scrollTop};this.events={play:function(){d.removeClass(this._360data.oUIBox,this._360data.className);this._360data.className=d.css.sPlaying;d.addClass(this._360data.oUIBox,this._360data.className);a.fanOut(this)},stop:function(){d.removeClass(this._360data.oUIBox,this._360data.className);this._360data.className=
"";a.fanIn(this)},pause:function(){d.removeClass(this._360data.oUIBox,this._360data.className);this._360data.className=d.css.sPaused;d.addClass(this._360data.oUIBox,this._360data.className)},resume:function(){d.removeClass(this._360data.oUIBox,this._360data.className);this._360data.className=d.css.sPlaying;d.addClass(this._360data.oUIBox,this._360data.className)},finish:function(){var b;d.removeClass(this._360data.oUIBox,this._360data.className);this._360data.className="";this._360data.didFinish=
!0;a.fanIn(this);d.config.playNext&&(b=d.indexByURL[this._360data.oLink.href]+1,b<d.links.length&&d.handleClick({target:d.links[b]}))},whileloading:function(){this.paused&&a.updatePlaying.apply(this)},whileplaying:function(){a.updatePlaying.apply(this);this._360data.fps++},bufferchange:function(){this.isBuffering?d.addClass(this._360data.oUIBox,d.css.sBuffering):d.removeClass(this._360data.oUIBox,d.css.sBuffering)}};this.stopEvent=function(b){if(typeof b!=="undefined"&&typeof b.preventDefault!=="undefined")b.preventDefault();
else if(typeof g.event!=="undefined"&&typeof g.event.returnValue!=="undefined")g.event.returnValue=!1;return!1};this.getTheDamnLink=o?function(b){return b&&b.target?b.target:g.event.srcElement}:function(b){return b.target};this.handleClick=function(b){if(b.button>1)return!0;var e=a.getTheDamnLink(b),f,c,i,h,d;if(e.nodeName.toLowerCase()!=="a"&&(e=a.isChildOfNode(e,"a"),!e))return!0;if(!a.isChildOfClass(e,"ui360"))return!0;e.getAttribute("href");if(!e.href||!n.canPlayLink(e)||a.hasClass(e,a.excludeClass))return!0;
n._writeDebug("handleClick()");f=e.href;if(c=a.getSoundByURL(f))c===a.lastSound?c.togglePause():(c.togglePause(),n._writeDebug("sound different than last sound: "+a.lastSound.sID),!a.config.allowMultiple&&a.lastSound&&a.stopSound(a.lastSound));else{i=e.parentNode;h=a.getElementsByClassName("ui360-vis","div",i.parentNode).length;c=n.createSound({id:"ui360Sound"+a.soundCount++,url:f,onplay:a.events.play,onstop:a.events.stop,onpause:a.events.pause,onresume:a.events.resume,onfinish:a.events.finish,onbufferchange:a.events.bufferchange,
whileloading:a.events.whileloading,whileplaying:a.events.whileplaying,useWaveformData:h&&a.config.useWaveformData,useEQData:h&&a.config.useEQData,usePeakData:h&&a.config.usePeakData});d=parseInt(a.getElementsByClassName("sm2-360ui","div",i)[0].offsetWidth,10);c._360data={oUI360:a.getParentByClassName(e,"ui360"),oLink:e,className:a.css.sPlaying,oUIBox:a.getElementsByClassName("sm2-360ui","div",i)[0],oCanvas:a.getElementsByClassName("sm2-canvas","canvas",i)[0],oButton:a.getElementsByClassName("sm2-360btn",
"span",i)[0],oTiming:a.getElementsByClassName("sm2-timing","div",i)[0],oCover:a.getElementsByClassName("sm2-cover","div",i)[0],circleDiameter:d,circleRadius:d/2,lastTime:null,didFinish:null,pauseCount:0,radius:0,fontSize:1,fontSizeMax:a.config.fontSizeMax,scaleFont:h&&a.config.scaleFont,showHMSTime:h,amplifier:h&&a.config.usePeakData?0.9:1,radiusMax:d*0.175,width:0,widthMax:d*0.4,lastValues:{bytesLoaded:0,bytesTotal:0,position:0,durationEstimate:0},animating:!1,oAnim:new g.Animator({duration:a.config.animDuration,
transition:a.config.animTransition,onComplete:function(){}}),oAnimProgress:function(b){this._360data.radius=parseInt(this._360data.radiusMax*this._360data.amplifier*b,10);this._360data.width=parseInt(this._360data.widthMax*this._360data.amplifier*b,10);if(this._360data.scaleFont&&this._360data.fontSizeMax!==null)this._360data.oTiming.style.fontSize=parseInt(Math.max(1,this._360data.fontSizeMax*b),10)+"px",this._360data.oTiming.style.opacity=b;(this.paused||this.playState===0||this._360data.lastValues.bytesLoaded===
0||this._360data.lastValues.position===0)&&a.updatePlaying.apply(this)},fps:0};if(typeof a.Metadata!=="undefined"&&a.getElementsByClassName("metadata","div",c._360data.oUI360).length)c._360data.metadata=new a.Metadata(c,a);if(c._360data.scaleFont&&c._360data.fontSizeMax!==null)c._360data.oTiming.style.fontSize="1px";c._360data.oAnim.addSubject(c._360data.oAnimProgress,c);a.refreshCoords(c);a.updatePlaying.apply(c);a.soundsByURL[f]=c;a.sounds.push(c);!a.config.allowMultiple&&a.lastSound&&a.stopSound(a.lastSound);
c.play()}a.lastSound=c;if(typeof b!=="undefined"&&typeof b.preventDefault!=="undefined")b.preventDefault();else if(typeof g.event!=="undefined")g.event.returnValue=!1;return!1};this.fanOut=function(b){if(b._360data.animating===1)return!1;b._360data.animating=0;soundManager._writeDebug("fanOut: "+b.sID+": "+b._360data.oLink.href);b._360data.oAnim.seekTo(1);g.setTimeout(function(){b._360data.animating=0},a.config.animDuration+20)};this.fanIn=function(b){if(b._360data.animating===-1)return!1;b._360data.animating=
-1;soundManager._writeDebug("fanIn: "+b.sID+": "+b._360data.oLink.href);b._360data.oAnim.seekTo(0);g.setTimeout(function(){b._360data.didFinish=!1;b._360data.animating=0;a.resetLastValues(b)},a.config.animDuration+20)};this.resetLastValues=function(b){b._360data.lastValues.position=0};this.refreshCoords=function(b){b._360data.canvasXY=a.findXY(b._360data.oCanvas);b._360data.canvasMid=[b._360data.circleRadius,b._360data.circleRadius];b._360data.canvasMidXY=[b._360data.canvasXY[0]+b._360data.canvasMid[0],
b._360data.canvasXY[1]+b._360data.canvasMid[1]]};this.stopSound=function(b){soundManager._writeDebug("stopSound: "+b.sID);soundManager.stop(b.sID);m||soundManager.unload(b.sID)};this.buttonClick=function(b){a.handleClick({target:a.getParentByClassName(b?b.target?b.target:b.srcElement:g.event.srcElement,"sm2-360ui").nextSibling});return!1};this.buttonMouseDown=function(b){m?a.addEventHandler(document,"touchmove",a.mouseDown):document.onmousemove=function(b){a.mouseDown(b)};a.stopEvent(b);return!1};
this.mouseDown=function(b){if(!m&&b.button>1)return!0;if(!a.lastSound)return a.stopEvent(b),!1;var e=b?b:g.event;m&&e.touches&&(e=e.touches[0]);e=a.getSoundByURL(a.getElementsByClassName("sm2_link","a",a.getParentByClassName(e.target||e.srcElement,"ui360"))[0].href);a.lastTouchedSound=e;a.refreshCoords(e);e=e._360data;a.addClass(e.oUIBox,"sm2_dragging");e.pauseCount=a.lastTouchedSound.paused?1:0;a.mmh(b?b:g.event);m?(a.removeEventHandler(document,"touchmove",a.mouseDown),a.addEventHandler(document,
"touchmove",a.mmh),a.addEventHandler(document,"touchend",a.mouseUp)):(document.onmousemove=a.mmh,document.onmouseup=a.mouseUp);a.stopEvent(b);return!1};this.mouseUp=function(){var b=a.lastTouchedSound._360data;a.removeClass(b.oUIBox,"sm2_dragging");b.pauseCount===0&&a.lastTouchedSound.resume();m?(a.removeEventHandler(document,"touchmove",a.mmh),a.removeEventHandler(document,"touchend",a.mouseUP)):(document.onmousemove=null,document.onmouseup=null)};this.mmh=function(b){if(typeof b==="undefined")b=
g.event;var e=a.lastTouchedSound,f=a.getMouseXY(b),f=Math.floor(l-(a.rad2deg(Math.atan2(f[0]-e._360data.canvasMidXY[0],f[1]-e._360data.canvasMidXY[1]))+180));e.setPosition(e.durationEstimate*(f/l));a.stopEvent(b);return!1};this.drawSolidArc=function(b,e,f,d,i,m,g){var n=b,k;n.getContext&&(k=n.getContext("2d"));b=k;g||a.clearCanvas(n);if(e)k.fillStyle=e;b.beginPath();isNaN(i)&&(i=0);e=f-d;d=c||h;if(!d||d&&f>0)b.arc(0,0,f,m,i,!1),f=a.getArcEndpointCoords(e,i),b.lineTo(f.x,f.y),b.arc(0,0,e,i,m,!0),b.closePath(),
b.fill()};this.getArcEndpointCoords=function(b,a){return{x:b*Math.cos(a),y:b*Math.sin(a)}};this.deg2rad=function(b){return b*Math.PI/180};this.rad2deg=function(b){return b*180/Math.PI};this.getTime=function(b,a){var f=Math.floor(b/1E3),c=Math.floor(f/60);f-=c*60;return a?c+":"+(f<10?"0"+f:f):{min:c,sec:f}};this.clearCanvas=function(b){var a=null,c;b.getContext&&(a=b.getContext("2d"));c=b.offsetWidth;b=b.offsetHeight;a.clearRect(-(c/2),-(b/2),c,b)};this.updatePlaying=function(){var b=this._360data.showHMSTime?
a.getTime(this.position,!0):parseInt(this.position/1E3,10);if(this.bytesLoaded)this._360data.lastValues.bytesLoaded=this.bytesLoaded,this._360data.lastValues.bytesTotal=this.bytesTotal;if(this.position)this._360data.lastValues.position=this.position;if(this.durationEstimate)this._360data.lastValues.durationEstimate=this.durationEstimate;a.drawSolidArc(this._360data.oCanvas,a.config.backgroundRingColor,this._360data.width,this._360data.radius,a.deg2rad(l),!1);a.drawSolidArc(this._360data.oCanvas,this._360data.metadata?
a.config.loadRingColorMetadata:a.config.loadRingColor,this._360data.width,this._360data.radius,a.deg2rad(l*(this._360data.lastValues.bytesLoaded/this._360data.lastValues.bytesTotal)),0,!0);this._360data.lastValues.position!==0&&a.drawSolidArc(this._360data.oCanvas,this._360data.metadata?a.config.playRingColorMetadata:a.config.playRingColor,this._360data.width,this._360data.radius,a.deg2rad(this._360data.didFinish===1?l:l*(this._360data.lastValues.position/this._360data.lastValues.durationEstimate)),
0,!0);this._360data.metadata&&this._360data.metadata.events.whileplaying();if(b!==this._360data.lastTime)this._360data.lastTime=b,this._360data.oTiming.innerHTML=b;(this.instanceOptions.useWaveformData||this.instanceOptions.useEQData)&&s&&a.updateWaveform(this);a.config.useFavIcon&&a.vuMeter&&a.vuMeter.updateVU(this)};this.updateWaveform=function(b){if(!a.config.useWaveformData&&!a.config.useEQData||!n.features.waveformData&&!n.features.eqData)return!1;if(!b.waveformData.left.length&&!b.eqData.length&&
!b.peakData.left)return!1;b._360data.oCanvas.getContext("2d");var e=parseInt(b._360data.circleDiameter/2,10)/2,c,d,i,h,m,g,k,l,j;if(a.config.useWaveformData){i=a.config.waveformDataDownsample;i=Math.max(1,i);h=256/i;k=a.config.waveformDataOutside?1:a.config.waveformDataConstrain?0.5:0.565;e=a.config.waveformDataOutside?0.7:0.75;l=a.deg2rad(360/h*a.config.waveformDataLineRatio);for(c=0;c<256;c+=i)m=a.deg2rad(360*(c/h*1/i)),g=m+l,d=b.waveformData.left[c],d<0&&a.config.waveformDataConstrain&&(d=Math.abs(d)),
a.drawSolidArc(b._360data.oCanvas,a.config.waveformDataColor,b._360data.width*k,b._360data.radius*e*1.25*d,g,m,!0)}if(a.config.useEQData){i=a.config.eqDataDownsample;i=Math.max(1,i);h=192;k=a.config.eqDataOutside?1:0.565;d=a.config.eqDataOutside?-1:1;e=a.config.eqDataOutside?0.5:0.75;l=a.deg2rad(360/(h/i)*a.config.eqDataLineRatio);j=a.deg2rad(b._360data.didFinish===1?360:360*(b._360data.lastValues.position/b._360data.lastValues.durationEstimate));for(c=0;c<h;c+=i)m=a.deg2rad(360*(c/h)),g=m+l,a.drawSolidArc(b._360data.oCanvas,
g>j?a.config.eqDataColor:a.config.playRingColor,b._360data.width*k,b._360data.radius*e*b.eqData.left[c]*d,g,m,!0)}if(a.config.usePeakData&&!b._360data.animating){e=b.peakData.left||b.peakData.right;h=3;for(c=0;c<h;c++)e=e||b.eqData[c];b._360data.amplifier=a.config.useAmplifier?0.9+e*0.1:1;b._360data.radiusMax=b._360data.circleDiameter*0.175*b._360data.amplifier;b._360data.widthMax=b._360data.circleDiameter*0.4*b._360data.amplifier;b._360data.radius=parseInt(b._360data.radiusMax*b._360data.amplifier,
10);b._360data.width=parseInt(b._360data.widthMax*b._360data.amplifier,10)}};this.getUIHTML=function(b){return['<canvas class="sm2-canvas" width="'+b+'" height="'+b+'"></canvas>',' <span class="sm2-360btn sm2-360btn-default"></span>',' <div class="sm2-timing'+(navigator.userAgent.match(/safari/i)?" alignTweak":"")+'"></div>',' <div class="sm2-cover"></div>']};this.uiTest=function(b){var c=document.createElement("div"),f,d;c.className="sm2-360ui";f=document.createElement("div");f.className="ui360"+
(b?" "+b:"");c=f.appendChild(c.cloneNode(!0));f.style.position="absolute";f.style.left="-9999px";b=document.body.appendChild(f);d=a.getUIHTML(c.offsetWidth);c.innerHTML=d[1]+d[2]+d[3];c=parseInt(c.offsetWidth,10);d=parseInt(c/2,10);b=a.getElementsByClassName("sm2-timing","div",b)[0];b=parseInt(a.getStyle(b,"font-size"),10);isNaN(b)&&(b=null);f.parentNode.removeChild(f);return{circleDiameter:c,circleRadius:d,fontSizeMax:b}};this.init=function(b){n._writeDebug("threeSixtyPlayer.init()");var c=a.getElementsByClassName("ui360",
"div"),f,d,h=[],k=!1,l=0,j,s,p,r;f=0;for(d=c.length;f<d;f++)if(!(b&&c[f].id!=b))h.push(c[f].getElementsByTagName("a")[0]),c[f].style.backgroundImage="none";a.oUITemplate=document.createElement("div");a.oUITemplate.className="sm2-360ui";a.oUITemplateVis=document.createElement("div");a.oUITemplateVis.className="sm2-360ui";c=a.uiTest();a.config.circleDiameter=c.circleDiameter;a.config.circleRadius=c.circleRadius;s=a.uiTest("ui360-vis");a.config.fontSizeMax=s.fontSizeMax;a.oUITemplate.innerHTML=a.getUIHTML(a.config.circleDiameter).join("");
a.oUITemplateVis.innerHTML=a.getUIHTML(s.circleDiameter).join("");f=0;for(d=h.length;f<d;f++)if(n.canPlayLink(h[f])&&!a.hasClass(h[f],a.excludeClass))a.addClass(h[f],a.css.sDefault),a.links[l]=h[f],a.indexByURL[h[f].href]=l,l++,k=a.hasClass(h[f].parentNode,"ui360-vis"),j=(k?s:c).circleDiameter,b=(k?s:c).circleRadius,k=h[f].parentNode.insertBefore((k?a.oUITemplateVis:a.oUITemplate).cloneNode(!0),h[f]),o&&typeof g.G_vmlCanvasManager!=="undefined"?(p=document.createElement("canvas"),p.className="sm2-canvas",
r="sm2_canvas_"+parseInt(Math.random()*1048576,10),p.id=r,p.width=j,p.height=j,k.appendChild(p),g.G_vmlCanvasManager.initElement(p),j=document.getElementById(r)):j=h[f].parentNode.getElementsByTagName("canvas")[0],k=a.getElementsByClassName("sm2-cover","div",h[f].parentNode)[0],p=h[f].parentNode.getElementsByTagName("span")[0],a.addEventHandler(p,"click",a.buttonClick),m?a.addEventHandler(k,"touchstart",a.mouseDown):a.addEventHandler(k,"mousedown",a.mouseDown),j=j.getContext("2d"),j.translate(b,b),
j.rotate(a.deg2rad(-90));l>0&&(a.addEventHandler(document,"click",a.handleClick),a.config.autoPlay&&a.handleClick({target:a.links[0],preventDefault:function(){}}));n._writeDebug("threeSixtyPlayer.init(): Found "+l+" relevant items.");if(a.config.useFavIcon&&typeof this.VUMeter!=="undefined")this.vuMeter=new this.VUMeter(this)}}r.prototype.VUMeter=function(a){var d=this,g=document.getElementsByTagName("head")[0],j=navigator.userAgent.match(/opera/i),o=navigator.userAgent.match(/firefox/i);this.vuMeterData=
[];this.vuDataCanvas=null;this.setPageIcon=function(c){if(!a.config.useFavIcon||!a.config.usePeakData||!c)return!1;var h=document.getElementById("sm2-favicon");h&&(g.removeChild(h),h=null);if(!h)h=document.createElement("link"),h.id="sm2-favicon",h.rel="shortcut icon",h.type="image/png",h.href=c,document.getElementsByTagName("head")[0].appendChild(h)};this.resetPageIcon=function(){if(!a.config.useFavIcon)return!1;var c=document.getElementById("favicon");if(c)c.href="/favicon.ico"};this.updateVU=function(c){soundManager.flashVersion>=
9&&a.config.useFavIcon&&a.config.usePeakData&&d.setPageIcon(d.vuMeterData[parseInt(16*c.peakData.left,10)][parseInt(16*c.peakData.right,10)])};this.createVUData=function(){var a=0,h=0,k=d.vuDataCanvas.getContext("2d"),m=k.createLinearGradient(0,16,0,0),g=k.createLinearGradient(0,16,0,0);m.addColorStop(0,"rgb(0,192,0)");m.addColorStop(0.3,"rgb(0,255,0)");m.addColorStop(0.625,"rgb(255,255,0)");m.addColorStop(0.85,"rgb(255,0,0)");g.addColorStop(0,"rgba(0,0,0,0.2)");g.addColorStop(1,"rgba(0,0,0,0.5)");
for(a=0;a<16;a++)d.vuMeterData[a]=[];for(a=0;a<16;a++)for(h=0;h<16;h++)d.vuDataCanvas.setAttribute("width",16),d.vuDataCanvas.setAttribute("height",16),k.fillStyle=g,k.fillRect(0,0,7,15),k.fillRect(8,0,7,15),k.fillStyle=m,k.fillRect(0,15-a,7,16-(16-a)),k.fillRect(8,15-h,7,16-(16-h)),k.clearRect(0,3,16,1),k.clearRect(0,7,16,1),k.clearRect(0,11,16,1),d.vuMeterData[a][h]=d.vuDataCanvas.toDataURL("image/png")};this.testCanvas=function(){var a=document.createElement("canvas"),h=null;if(!a||typeof a.getContext===
"undefined")return null;h=a.getContext("2d");if(!h||typeof a.toDataURL!=="function")return null;try{a.toDataURL("image/png")}catch(d){return null}return a};this.init=function(){if(a.config.useFavIcon)d.vuDataCanvas=d.testCanvas(),d.vuDataCanvas&&(o||j)?d.createVUData():a.config.useFavIcon=!1};this.init()};r.prototype.Metadata=function(a,d){soundManager._wD("Metadata()");var g=this,j=a._360data.oUI360,o=j.getElementsByTagName("ul")[0].getElementsByTagName("li");navigator.userAgent.match(/firefox/i);
var c;this.lastWPExec=0;this.refreshInterval=250;this.totalTime=0;this.events={whileplaying:function(){var c=a._360data.width,k=a._360data.radius,m=a.durationEstimate||g.totalTime*1E3,j=null,l,b;l=0;for(b=g.data.length;l<b;l++)j=l%2===0,d.drawSolidArc(a._360data.oCanvas,j?d.config.segmentRingColorAlt:d.config.segmentRingColor,j?c:c,j?k/2:k/2,d.deg2rad(360*(g.data[l].endTimeMS/m)),d.deg2rad(360*((g.data[l].startTimeMS||1)/m)),!0);c=new Date;if(c-g.lastWPExec>g.refreshInterval)g.refresh(),g.lastWPExec=
c}};this.refresh=function(){var c,d,g=null,j=a.position,l=a._360data.metadata.data;c=0;for(d=l.length;c<d;c++)if(j>=l[c].startTimeMS&&j<=l[c].endTimeMS){g=c;break}if(g!==l.currentItem&&g<l.length)a._360data.oLink.innerHTML=l.mainTitle+' <span class="metadata"><span class="sm2_divider"> | </span><span class="sm2_metadata">'+l[g].title+"</span></span>",l.currentItem=g};this.strToTime=function(a){var a=a.split(":"),c=0,d;for(d=a.length;d--;)c+=parseInt(a[d],10)*Math.pow(60,a.length-1-d);return c};this.data=
[];this.data.givenDuration=null;this.data.currentItem=null;this.data.mainTitle=a._360data.oLink.innerHTML;for(c=0;c<o.length;c++)this.data[c]={o:null,title:o[c].getElementsByTagName("p")[0].innerHTML,startTime:o[c].getElementsByTagName("span")[0].innerHTML,startSeconds:g.strToTime(o[c].getElementsByTagName("span")[0].innerHTML.replace(/[()]/g,"")),duration:0,durationMS:null,startTimeMS:null,endTimeMS:null,oNote:null};j=d.getElementsByClassName("duration","div",j);this.data.givenDuration=j.length?
g.strToTime(j[0].innerHTML)*1E3:0;for(c=0;c<this.data.length;c++)this.data[c].duration=parseInt(this.data[c+1]?this.data[c+1].startSeconds:(g.data.givenDuration?g.data.givenDuration:a.durationEstimate)/1E3,10)-this.data[c].startSeconds,this.data[c].startTimeMS=this.data[c].startSeconds*1E3,this.data[c].durationMS=this.data[c].duration*1E3,this.data[c].endTimeMS=this.data[c].startTimeMS+this.data[c].durationMS,this.totalTime+=this.data[c].duration};if(navigator.userAgent.match(/webkit/i)&&navigator.userAgent.match(/mobile/i))soundManager.useHTML5Audio=
!0;soundManager.debugMode=g.location.href.match(/debug=1/i);soundManager.consoleOnly=!0;soundManager.flashVersion=9;soundManager.useHighPerformance=!0;soundManager.useFlashBlock=!0;soundManager.debugMode&&g.setInterval(function(){var a=g.threeSixtyPlayer;if(a&&a.lastSound&&a.lastSound._360data.fps&&typeof g.isHome==="undefined")soundManager._writeDebug("fps: ~"+a.lastSound._360data.fps),a.lastSound._360data.fps=0},1E3);g.ThreeSixtyPlayer=r})(window);window.threeSixtyPlayer=new ThreeSixtyPlayer;